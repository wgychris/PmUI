<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<link rel="shortcut icon" href="images/favicon.png">
<link rel="stylesheet" type="text/css"
	href="js/bootstrap.daterangepicker/daterangepicker-bs3.css" />

<title>PieceMaker</title>
<link
	href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,400italic,700,800'
	rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Raleway:300,200,100'
	rel='stylesheet' type='text/css'>

<!-- Bootstrap core CSS -->
<link href="js/bootstrap/dist/css/bootstrap.css" rel="stylesheet">
<link rel="stylesheet" type="text/css"
	href="js/bootstrap.switch/bootstrap-switch.min.css" />
<link rel="stylesheet" type="text/css"
	href="js/bootstrap.datetimepicker/css/bootstrap-datetimepicker.min.css" />

<!-- Select2 -->
<link rel="stylesheet" type="text/css"
	href="js/jquery.select2/select2.css" />


<!-- Slider -->
<link rel="stylesheet" type="text/css"
	href="js/bootstrap.slider/css/slider.css" />

<!-- DateRange -->
<link rel="stylesheet" type="text/css"
	href="js/bootstrap.daterangepicker/daterangepicker-bs3.css" />

<!-- Custom styles for this template -->
<link href="css/style.css" rel="stylesheet" />

<link rel="stylesheet"
	href="fonts/font-awesome-4/css/font-awesome.min.css">
<link rel="stylesheet" href="css/pygments.css">

<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <![endif]-->
<link rel="stylesheet" type="text/css"
	href="js/jquery.nanoscroller/nanoscroller.css" />
<link href="js/jquery.icheck/skins/square/blue.css" rel="stylesheet">
</head>

<body>

	<!-- Fixed navbar -->
	<div id="head-nav" class="navbar navbar-default navbar-fixed-top">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse"
					data-target=".navbar-collapse">
					<span class="fa fa-gear"></span>
				</button>
				<a class="navbar-brand" href="#"><span>PieceMaker</span></a>
			</div>
			<div class="navbar-collapse collapse">
				<ul class="nav navbar-nav">
					<li><a href="#">Home</a></li>
				</ul>

				<ul class="nav navbar-nav navbar-right user-nav">
					<li><a href="#">Dashboard</a></li>
					<li class="dropdown profile_menu"><a href="#"
						class="dropdown-toggle" data-toggle="dropdown"><img
							alt="Avatar" src="images/avatar2.jpg"><span>Jeff
								Hanneman</span> <b class="caret"></b></a>
						<ul class="dropdown-menu">
							<li><a href="#">My Account</a></li>
							<li><a href="#">Profile</a></li>
							<li><a href="#">Messages</a></li>
							<li class="divider"></li>
							<li><a href="#">Sign Out</a></li>
						</ul></li>
				</ul>

			</div>
			<!--/.nav-collapse -->
		</div>
	</div>


<div id="cl-wrapper" class="fixed-menu">
		<div class="cl-sidebar" data-position="right" data-step="1"
			data-intro="<strong>Fixed Sidebar</strong> <br/> It adjust to your needs.">
			<div class="cl-toggle">
				<i class="fa fa-bars"></i>
			</div>
			<div class="cl-navblock">
				<div class="menu-space">
					<div class="content">
						<div class="side-user">
							<div class="info">
								<a href="#">Piecemaker Analytics</a>
							</div>
						</div>
						<ul class="cl-vnavigation">
							<li><a href="#"><i class="fa fa-money"></i><span>Revenue
								</span></a>
								<ul class="sub-menu">
									<li><a href="anaTotRev.html">Total
											Revenue</a></li>
									<li><a href="anaRevPerCat.html">Revenue Per Category</a></li>
								</ul></li>

							<li><a href="#"><i class="fa fa-table"></i><span>Customer
										Behaviour </span></a>
								<ul class="sub-menu">
									<li class="active"><a href="anaCBTPer.html">Percentage</a></li>
									<li><a href="anaAvgTime.html">Average Time</a></li>
								</ul></li>

							<li><a href="#"><i class="fa fa-smile-o"></i><span>Popularity</span></a>
								<ul class="sub-menu">
									<li><a href="anaPopPiece.html">Popularity of Piece</a></li>
									<li><a href="anaPopCus.html">Popularity of
											Customization</a></li>
								</ul></li>
							<li><a href="anaCusInfo.html"><i class="fa fa-eye"></i><span>Customer
										Info</span></a>
							<li><a href="anaPriSta.html"><i class="fa fa-cogs"></i><span>Print
										Station Analysis</span></a>
						</ul>
					</div>
				</div>
			</div>
		</div>




		<div class="container-fluid" id="pcont">
			<div class="page-head">
				<ol class="breadcrumb">
					<li><a href="anaTotRev.html">Home</a></li>
					<li>Customer Behavior Analytics</li>
					<li class="active">Customer Behavior</li>
				</ol>
			</div>
			
			<div class="cl-mcont">
				<div class="row">


					<div class="col-sm-12 col-md-12">

					<div class="form-group">
								
							</div>
							
							<div class="form-group">
								<label class="col-sm-2 control-label">Date & Time Picker</label>
								<div class="col-sm-4">
									<div id="reportrange" class="pull-left"
										style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc">
										<i class="glyphicon glyphicon-calendar fa fa-calendar"></i> <span></span>
										<b class="caret"></b>
									</div>
								</div>
							</div>


							<div class="form-group">
							<label class="col-sm-2 control-label"></label>
								<label class="col-sm-1 control-label">Select</label>
								<div class="col-sm-3">
									
									<select class="form-control" 
									style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc" onChange="selectRevenueChange()" id="selectRevenueOpt">
									<option>Daily Status</option>
									<option>Weekly Status</option>
									<option>Monthly Status</option>
								</select>
								</div>
							</div>

							<br> <br> 

						<div class="block-flat">

							<div id="CBTPer"></div>
						</div>

					</div>
				</div>
			</div>
		</div>

	</div>
	<script
		src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<script src="http://code.highcharts.com/highcharts.js"></script>
	<script src="http://code.highcharts.com/modules/exporting.js"></script>

	<script type="text/javascript"
		src="js/jquery.nanoscroller/jquery.nanoscroller.js"></script>
	<script type="text/javascript"
		src="js/jquery.sparkline/jquery.sparkline.min.js"></script>
	<script type="text/javascript"
		src="js/jquery.easypiechart/jquery.easy-pie-chart.js"></script>
	<script type="text/javascript" src="js/behaviour/general.js"></script>
	<script src="js/jquery.ui/jquery-ui.js" type="text/javascript"></script>
	<script type="text/javascript"
		src="js/jquery.nestable/jquery.nestable.js"></script>
	<script type="text/javascript"
		src="js/bootstrap.switch/bootstrap-switch.min.js"></script>
	<script type="text/javascript"
		src="js/bootstrap.datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
	<script src="js/jquery.select2/select2.min.js" type="text/javascript"></script>
	<script src="js/bootstrap.slider/js/bootstrap-slider.js"
		type="text/javascript"></script>
	<script type="text/javascript"
		src="js/jquery.gritter/js/jquery.gritter.js"></script>
		
		<script type="text/javascript"
			src="js/bootstrap.daterangepicker/moment.min.js"></script>
		<script type="text/javascript"
			src="js/bootstrap.daterangepicker/daterangepicker.js"></script>

<script type="text/javascript">
		$(document).ready(function() {
			//initialize the javascript
			App.init();
			App.charts();
		});
	</script>


	<script>
	var startDate;
	var endDate;
	
	
	$(function () {
		
		var options = {
				chart: {
					 renderTo: 'CBTPer',
					 type: 'column'
				},
		            
		        title: {
		            text: 'Customer Behaviour Analysis'
		        },
		        xAxis: {
		            categories: [
		                'Jan',
		                'Feb',
		                'Mar',
		                'Apr',
		                'May',
		                'Jun',
		                'Jul',
		                'Aug'
		            ]
		        },
		        yAxis: {
		            min: 0,
		            max: 100,
		            title: {
		                text: 'Percentage (%)'
		            }
		        },
		        tooltip: {
		            headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
		            pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
		                '<td style="padding:0"><b>{point.y:.1f} %</b></td></tr>',
		            footerFormat: '</table>',
		            shared: true,
		            useHTML: true
		        },
		        plotOptions: {
		            column: {
		                pointPadding: 0.11,
		                borderWidth: 0
		            }
		        },
		        series: [{
		            name: 'Conversion Rates',
		            data: []

		        }, {
		            name: 'Customization Rates',
		            data: []

		        }, {
		            name: 'Finalization Rates',
		            data: []

		        }]
		   
		};
		
		$.getJSON("./getBehaviour.php", function(result) {
			options.xAxis.categories = result.dateArr;
  			options.series[0].data = result.coversionArr;
            options.series[1].data = result.customizationArr;
            options.series[2].data = result.finalizationArr;
             chart = new Highcharts.Chart(options);
        });
		
		
		
	   
	});
	
	function selectRevenueChange(){
		
		var options = {
				chart: {
					 renderTo: 'CBTPer',
					 type: 'column'
				},
		            
		        title: {
		            text: 'Customer Behaviour Analysis'
		        },
		        xAxis: {
		            categories: [
		                'Jan',
		                'Feb',
		                'Mar',
		                'Apr',
		                'May',
		                'Jun',
		                'Jul',
		                'Aug'
		            ]
		        },
		        yAxis: {
		            min: 0,
		            max: 100,
		            title: {
		                text: 'Percentage (%)'
		            }
		        },
		        tooltip: {
		            headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
		            pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
		                '<td style="padding:0"><b>{point.y:.1f} %</b></td></tr>',
		            footerFormat: '</table>',
		            shared: true,
		            useHTML: true
		        },
		        plotOptions: {
		            column: {
		                pointPadding: 0.11,
		                borderWidth: 0
		            }
		        },
		        series: [{
		            name: 'Conversion Rates',
		            data: []

		        }, {
		            name: 'Customization Rates',
		            data: []

		        }, {
		            name: 'Finalization Rates',
		            data: []

		        }]
		   
		};
		
		  var myselect = document.getElementById("selectRevenueOpt");
		  var option = myselect.options[myselect.selectedIndex].label;
		  var timeStr = "";
		  if (startDate != null && endDate != null) {
			  var timeStr = "?startDate="+startDate+"&endDate="+endDate;
		  }
		  switch (option) {
		  case 'Weekly Status': $.getJSON("./getWeeklyBehaviour.php"+timeStr, function(result) {
			  options.xAxis.categories = result.dateArr;
	  			options.series[0].data = result.coversionArr;
	            options.series[1].data = result.customizationArr;
	            options.series[2].data = result.finalizationArr;
                chart = new Highcharts.Chart(options);
            }); break;
		  case 'Monthly Status': $.getJSON("./getMonthlyBehaviour.php"+timeStr, function(result) {
			  options.xAxis.categories = result.dateArr;
	  			options.series[0].data = result.coversionArr;
	            options.series[1].data = result.customizationArr;
	            options.series[2].data = result.finalizationArr;
                chart = new Highcharts.Chart(options);
            }); break;
		  case 'Daily Status': $.getJSON("./getBehaviour.php"+timeStr, function(result) {
			  options.xAxis.categories = result.dateArr;
	  			options.series[0].data = result.coversionArr;
	            options.series[1].data = result.customizationArr;
	            options.series[2].data = result.finalizationArr;
                chart = new Highcharts.Chart(options);
            }); break;
		  }
		}
	</script>


	<script type="text/javascript">
			$(document)
					.ready(
							function() {
								//initialize the javascript

								$('#reservation').daterangepicker();
								$('#reservationtime').daterangepicker({
									timePicker : true,
									timePickerIncrement : 30,
									format : 'MM/DD/YYYY h:mm A'
								});
								var cb = function(start, end) {
									$('#reportrange span')
											.html(
													start
															.format('MMMM D, YYYY')
															+ ' - '
															+ end
																	.format('MMMM D, YYYY'));
									
									refreshGraph(start.format('YYYY-MM-DD'), end.format('YYYY-MM-DD'));
									startDate = start.format('YYYY-MM-DD');
									endDate = end.format('YYYY-MM-DD');
									
								}

								var optionSet1 = {
									startDate : moment().subtract('days', 29),
									endDate : moment(),
									minDate : '01/01/2012',
									maxDate : '12/31/2014',
									dateLimit : {
										days : 60
									},
									showDropdowns : true,
									showWeekNumbers : true,
									timePicker : false,
									timePickerIncrement : 1,
									timePicker12Hour : true,
									opens : 'left',
									buttonClasses : [ 'btn' ],
									applyClass : 'btn-small btn-primary',
									cancelClass : 'btn-small',
									format : 'MM/DD/YYYY',
									separator : ' to ',
									locale : {
										applyLabel : 'Submit',
										cancelLabel : 'Clear',
										fromLabel : 'From',
										toLabel : 'To',
										customRangeLabel : 'Custom',
										daysOfWeek : [ 'Su', 'Mo', 'Tu', 'We',
												'Th', 'Fr', 'Sa' ],
										monthNames : [ 'January', 'February',
												'March', 'April', 'May',
												'June', 'July', 'August',
												'September', 'October',
												'November', 'December' ],
										firstDay : 1
									}
								};

							
								$('#reportrange span').html(
										moment().subtract('days', 29).format(
												'MMMM D, YYYY')
												+ ' - '
												+ moment().format(
														'MMMM D, YYYY'));

								$('#reportrange').daterangepicker(optionSet1,
										cb);

							});
			
			
			function refreshGraph(startDate, endDate) {

				var options = {
						chart: {
							 renderTo: 'CBTPer',
							 type: 'column'
						},
				            
				        title: {
				            text: 'Customer Behaviour Analysis'
				        },
				        xAxis: {
				            categories: [
				                'Jan',
				                'Feb',
				                'Mar',
				                'Apr',
				                'May',
				                'Jun',
				                'Jul',
				                'Aug'
				            ]
				        },
				        yAxis: {
				            min: 0,
				            max: 100,
				            title: {
				                text: 'Percentage (%)'
				            }
				        },
				        tooltip: {
				            headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
				            pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
				                '<td style="padding:0"><b>{point.y:.1f} %</b></td></tr>',
				            footerFormat: '</table>',
				            shared: true,
				            useHTML: true
				        },
				        plotOptions: {
				            column: {
				                pointPadding: 0.11,
				                borderWidth: 0
				            }
				        },
				        series: [{
				            name: 'Conversion Rates',
				            data: []

				        }, {
				            name: 'Customization Rates',
				            data: []

				        }, {
				            name: 'Finalization Rates',
				            data: []

				        }]
				   
				};
				/* var url = "./getBehaviour.php?startDate="+startDate+"&endDate="+endDate;
				$.getJSON(url, function(result) {
					options.xAxis.categories = result.dateArr;
		  			options.series[0].data = result.coversionArr;
		            options.series[1].data = result.customizationArr;
		            options.series[2].data = result.finalizationArr;
	                chart = new Highcharts.Chart(options);
				}); */
				var myselect = document.getElementById("selectRevenueOpt");
				  var option = myselect.options[myselect.selectedIndex].label;
				  var timeStr = "";
				  if (startDate != null && endDate != null) {
					  var timeStr = "?startDate="+startDate+"&endDate="+endDate;
				  }
				  switch (option) {
				  case 'Weekly Status': $.getJSON("./getWeeklyBehaviour.php"+timeStr, function(result) {
					  options.xAxis.categories = result.dateArr;
			  			options.series[0].data = result.coversionArr;
			            options.series[1].data = result.customizationArr;
			            options.series[2].data = result.finalizationArr;
		                chart = new Highcharts.Chart(options);
		            }); break;
				  case 'Monthly Status': $.getJSON("./getMonthlyBehaviour.php"+timeStr, function(result) {
					  options.xAxis.categories = result.dateArr;
			  			options.series[0].data = result.coversionArr;
			            options.series[1].data = result.customizationArr;
			            options.series[2].data = result.finalizationArr;
		                chart = new Highcharts.Chart(options);
		            }); break;
				  case 'Daily Status': $.getJSON("./getBehaviour.php"+timeStr, function(result) {
					  options.xAxis.categories = result.dateArr;
			  			options.series[0].data = result.coversionArr;
			            options.series[1].data = result.customizationArr;
			            options.series[2].data = result.finalizationArr;
		                chart = new Highcharts.Chart(options);
		            }); break;
				  }

			}
		</script>


	<!-- Bootstrap core JavaScript
    ================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="js/behaviour/voice-commands.js"></script>
	<script src="js/bootstrap/dist/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/jquery.flot/jquery.flot.js"></script>
	<script type="text/javascript" src="js/jquery.flot/jquery.flot.pie.js"></script>
	<script type="text/javascript"
		src="js/jquery.flot/jquery.flot.resize.js"></script>
	<script type="text/javascript"
		src="js/jquery.flot/jquery.flot.labels.js"></script>
</body>
</html>
