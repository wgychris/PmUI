<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<link rel="shortcut icon" href="images/PieceMaker.jpg">

<title>PieceMaker</title>
<link
	href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,400italic,700,800'
	rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Raleway:300,200,100'
	rel='stylesheet' type='text/css'>

<!-- Bootstrap core CSS -->
<link href="js/bootstrap/dist/css/bootstrap.css" rel="stylesheet">
<link rel="stylesheet" type="text/css"
	href="js/bootstrap.switch/bootstrap-switch.min.css" />
<link rel="stylesheet" type="text/css"
	href="js/bootstrap.datetimepicker/css/bootstrap-datetimepicker.min.css" />

<!-- Select2 -->
<link rel="stylesheet" type="text/css"
	href="js/jquery.select2/select2.css" />


<!-- Slider -->
<link rel="stylesheet" type="text/css"
	href="js/bootstrap.slider/css/slider.css" />

<!-- DateRange -->
<link rel="stylesheet" type="text/css"
	href="js/bootstrap.daterangepicker/daterangepicker-bs3.css" />

<!-- Custom styles for this template -->
<link href="css/style.css" rel="stylesheet" />

<link rel="stylesheet"
	href="fonts/font-awesome-4/css/font-awesome.min.css">
<link rel="stylesheet" href="css/pygments.css">

<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <![endif]-->
<link rel="stylesheet" type="text/css"
	href="js/jquery.nanoscroller/nanoscroller.css" />
<link href="js/jquery.icheck/skins/square/blue.css" rel="stylesheet">

</head>

<body>

		<!-- Fixed navbar -->
	<div id="head-nav" class="navbar navbar-default navbar-fixed-top">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse"
					data-target=".navbar-collapse">
					<span class="fa fa-gear"></span>
				</button>
				<a class="navbar-brand" href="#"><span>PieceMaker</span></a>
			</div>
			<div class="navbar-collapse collapse">
				<ul class="nav navbar-nav">
					<li><a href="anaTotRev.html">Home</a></li>
				</ul>
				<ul class="nav navbar-nav navbar-right user-nav">
					<li><a href="#">Dashboard</a></li>
				</ul>

			</div>
			<!--/.nav-collapse -->
		</div>
	</div>


	<div id="cl-wrapper">
		<div class="cl-sidebar">
			<div class="cl-toggle">
				<i class="fa fa-bars"></i>
			</div>
			<div class="cl-navblock">
				<div class="menu-space">
					<div class="content">
						<div class="side-user">
							<div class="info">
								<a href="#">Piecemaker Analytics</a>
							</div>
						</div>
						<ul class="cl-vnavigation">

							<li><a href="#"><i class="fa fa-money"></i><span>Revenue
								</span></a>
								<ul class="sub-menu">
									<li><a href="anaTotRev.html">Total Revenue</a></li>
									<li class="active"><a href="anaRevPerCat.html">Revenue Per Category</a></li>
								</ul></li>

							<li><a href="anaCBTPer.html"><i class="fa fa-eye"></i><span>Customer
										Behaviour </span></a>
							</li>

							<li><a href="#"><i class="fa fa-smile-o"></i><span>Popularity</span></a>
								<ul class="sub-menu">
									<li><a href="anaPopPiece.html">Popularity of Piece</a></li>
									<li><a href="anaPopCus.html">Popularity of
											Customization</a></li>
								</ul></li>
							<li><a href="anaCusInfo.html"><i class="fa fa-table"></i><span>Customer
										Info</span></a></li>
							<li><a href="anaPriSta.html"><i class="fa fa-bar-chart-o"></i><span>Print
										Station Analysis</span></a></li>
						</ul>
					</div>
				</div>
				
				<div class="text-right collapse-button" style="padding: 7px 9px;">
					<button id="sidebar-collapse" class="btn btn-default" style="">
						<i style="color: #fff;" class="fa fa-angle-left"></i>
					</button>
				</div>
				
			</div>
		</div>


		<div class="container-fluid" id="pcont">
			<div class="page-head">
				<ol class="breadcrumb">
					<li><a href="#">Home</a></li>
					<li><a href="#">Revenue Analytics</a></li>
					<li class="active">Revenue Per Category</li>
				</ol>
			</div>


			<div class="cl-mcont">
				<div class="row">


					<div class="col-sm-12 col-md-12">

						<div class="block-flat">

							<div id="revenuePerCat">
								<p>Chart of Piece</p>
							</div>
						</div>

					</div>
					
						<div class="col-sm-12 col-md-12">

						<div class="block-flat">

							<div id="revPerPiece">
								<p>Chart of Piece</p>
							</div>
						</div>

					</div>
				</div>
			</div>
		</div>

	</div>
	<script
		src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<script src="http://code.highcharts.com/highcharts.js"></script>
	<script src="http://code.highcharts.com/modules/exporting.js"></script>

	<script type="text/javascript"
		src="js/jquery.nanoscroller/jquery.nanoscroller.js"></script>
	<script type="text/javascript"
		src="js/jquery.sparkline/jquery.sparkline.min.js"></script>
	<script type="text/javascript"
		src="js/jquery.easypiechart/jquery.easy-pie-chart.js"></script>
	<script type="text/javascript" src="js/behaviour/general.js"></script>
	<script src="js/jquery.ui/jquery-ui.js" type="text/javascript"></script>
	<script type="text/javascript"
		src="js/jquery.nestable/jquery.nestable.js"></script>
	<script type="text/javascript"
		src="js/bootstrap.switch/bootstrap-switch.min.js"></script>
	<script type="text/javascript"
		src="js/bootstrap.datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
	<script src="js/jquery.select2/select2.min.js" type="text/javascript"></script>
	<script src="js/bootstrap.slider/js/bootstrap-slider.js"
		type="text/javascript"></script>
	<script type="text/javascript"
		src="js/jquery.gritter/js/jquery.gritter.js"></script>

	<script type="text/javascript">
		$(document).ready(function() {
			//initialize the javascript
			App.init();
			App.charts();
		});
	</script>

	<script src="http://code.highcharts.com/modules/data.js"></script>

	<div id="container"
		style="min-width: 310px; max-width: 600px; height: 400px; margin: 0 auto"></div>

	
	<script type="text/javascript">
		var options = {
				chart : {
					renderTo: 'revenuePerCat',
					type : 'pie'
				},
				title : {
					text : 'Revenue Per Category'
				},
				plotOptions : {
					series : {
						dataLabels : {
							enabled : true,
							format : '{point.name}: {point.y:.1f}'
							
						},
						
				             point: {
				                 events: {
				                     click: function() {
				                    	/* var testobj = this;
				                    	alert(this.name); */
				                    	refreshGraph(this.name);
				                     }
				                 }
				             }
				         
					}
					
				},

				tooltip : {
					headerFormat : '<span style="font-size:11px">{series.name}</span><br>',
					pointFormat : '<span style="color:{point.color}">{point.name}</span>: <b>{point.y:.2f}</b><br/>'
				},

				series : [ {
					name : 'Category',
					colorByPoint : true,
					data : []
				} ],
				drilldown : {
					series : []
				}
		};
		
		$.getJSON("./getRevenueByCategories.php", function(result) {
            options.series[0].data = result.categoryArr;
            options.drilldown.series = result.drilldownArr;
            chart = new Highcharts.Chart(options);
        });
	</script>

	<script>
		
		function refreshGraph(categoryName){
		var option = {
				chart : {
					renderTo: 'revPerPiece',
				},
				title : {
					text : 'Revenue Per Piece',
					x : -20
				//center
				},
				xAxis : {
					categories : []
				},
				yAxis : {
					title : {
						text : 'Revenue ($)'
					},
					plotLines : [ {
						value : 0,
						width : 1,
						color : '#808080'
					} ]
				},
				tooltip : {
					valuePrefix : '$'
				},
				legend : {
					layout : 'vertical',
					align : 'right',
					verticalAlign : 'middle',
					borderWidth : 0
				},
				plotOptions: {
			         pie: {
			             point: {
			                 events: {
			                     click: function() {
			                        //logic for drill down goes here          
			                        alert('Hello');
			                     }
			                 }
			             }
			         }
			     },
				series : []
			}
		
		$.getJSON("./getPieceRevenueByCategory.php?category="+categoryName, function(result) {
            option.xAxis.categories = result.dateArr;
            option.series = result.data;
            chart = new Highcharts.Chart(option);
        });
		
		}
	</script>
	<!-- Bootstrap core JavaScript
    ================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="js/behaviour/voice-commands.js"></script>
	<script src="js/bootstrap/dist/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/jquery.flot/jquery.flot.js"></script>
	<script type="text/javascript" src="js/jquery.flot/jquery.flot.pie.js"></script>
	<script type="text/javascript"
		src="js/jquery.flot/jquery.flot.resize.js"></script>
	<script type="text/javascript"
		src="js/jquery.flot/jquery.flot.labels.js"></script>
</body>
</html>
